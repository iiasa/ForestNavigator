<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Interfaces &mdash; ForestNavigator  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Determining the modality of execution" href="determining-the-modality-of-execution.html" />
    <link rel="prev" title="Networking" href="networking.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #C8C8C8" >
            <a href="../index.html">
            <img src="../_static/ForestNavigator_logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v2023-4-21
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
   
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../managing-code-and-data.html">Managing Code and Data</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../containerization.html">Containerization</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="images-and-containers.html">Images and Containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="advantages.html">Advantages</a></li>
<li class="toctree-l2"><a class="reference internal" href="technical_background.html">Technical background</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="files.html">Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="networking.html">Networking</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Interfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#informal-interfacing-via-input-output-files">Informal interfacing via input/output files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#formal-interfaces">Formal interfaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prohibition-of-access-by-default">Prohibition of access by default</a></li>
<li class="toctree-l4"><a class="reference internal" href="#separation-from-implementation">Separation from implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adopting-an-existing-formal-interface-or-protocol">Adopting an existing formal interface or protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="#in-practice">In practice</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#interfacing-via-a-message-broker">Interfacing via a message broker</a></li>
<li class="toctree-l3"><a class="reference internal" href="#application-programming-interfaces">Application Programming Interfaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="determining-the-modality-of-execution.html">Determining the modality of execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflows.html">Workflows</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../IT-infrastructure.html">IT Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../summary.html">Summary</a></li>
</ul>

   <p class="caption">
     <span class="caption-text">References:</span>
   </p>
   <ul>
        <li class="toctree-l1"><a href= "../genindex.html">Index</a></li>
   </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #C8C8C8" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ForestNavigator</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../containerization.html">Containerization</a></li>
      <li class="breadcrumb-item active">Interfaces</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="interfaces">
<h1>Interfaces<a class="headerlink" href="#interfaces" title="Permalink to this heading"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p id="index-0">To collaborate, containers will need to exchange data. Because containers are
isolated environments, a little planning is required to create an <strong>interface</strong>
for data exchange.</p>
</section>
<section id="informal-interfacing-via-input-output-files">
<h2>Informal interfacing via input/output files<a class="headerlink" href="#informal-interfacing-via-input-output-files" title="Permalink to this heading"></a></h2>
<p>When your containerized software runs as a job that takes input when started,
runs to completion, and produces output when it ends — as might be the case for
a numerical model — an informal interface based on files is a simple option.
The input files can be provided to the container and the output files can be
obtained from the container via <a class="reference internal" href="files.html#file-volumes"><span class="std std-ref">file volumes</span></a> shared with
other containers.</p>
<p>By clearly documenting the input and output files, the container becomes usable
by other containers. Setting up the volumes and starting the container can be
orchestrated outside of the container: the containerized software does not need
to to make provisions for that.</p>
<p>Since reading or writing multiple files is not an atomic operation, there may be
need to protect the file exchange by means of <a class="reference external" href="https://en.wikipedia.org/wiki/File_locking#Lock_files">lock files</a> or another
synchronization method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When you are comfortable with implementing a more formal interface (see
below), doing so is preferred over using files, even for a simple use case
such as a job container.</p>
</div>
</section>
<section id="formal-interfaces">
<span id="index-1"></span><h2>Formal interfaces<a class="headerlink" href="#formal-interfaces" title="Permalink to this heading"></a></h2>
<p>When your containerized software has to wait for and react to inputs, possibly
producing output in response, one or more <strong>formal interfaces</strong> should be
defined. This section explains why and provides guidance on how to get started
with defining a formal interface.</p>
<section id="prohibition-of-access-by-default">
<h3>Prohibition of access by default<a class="headerlink" href="#prohibition-of-access-by-default" title="Permalink to this heading"></a></h3>
<p>A key principle of software design is to prohibit access to all resources of a
software component by default, allowing access only through well-defined entry
points, i.e., interfaces. This prevents the internal state of the software
component from being messed up outside of its control.</p>
<p>A software component deployed in a container automatically complies with this
principle when it comes to its interactions with software outside the container:
the container environment is isolated by default, access to the container
requires the explicit configuration of entry points (such as a TCP/IP port).</p>
</section>
<section id="separation-from-implementation">
<h3>Separation from implementation<a class="headerlink" href="#separation-from-implementation" title="Permalink to this heading"></a></h3>
<p>The specification of a formal interface to a software component <em>A</em> should be
independent of its implementation. Publishing the formal interface specification
then allows a different software component <em>B</em> to be coded that communicates
with <em>A</em> through its interface such that when the implementation of <em>A</em> is
updated, <em>B</em> will not fail.</p>
</section>
<section id="adopting-an-existing-formal-interface-or-protocol">
<h3>Adopting an existing formal interface or protocol<a class="headerlink" href="#adopting-an-existing-formal-interface-or-protocol" title="Permalink to this heading"></a></h3>
<p>Adopting a fit-for-purpose existing formal interface specification enables the
re-use of already-existing software that is written and tested to comply with
that specification. Test suites that exercise the interface likely exists and
can be re-used. And the specification documentation already exists somewhere and
does not have to be written.</p>
<p id="index-2">Finding a good fit may not be possible, but picking a suitable standard
data-exchange <strong>protocol</strong> always is. Such a protocol will have a specification and
libraries for various languages. Then you only will need to add specializations
on top, and document those to complete the interface.</p>
</section>
<section id="in-practice">
<h3>In practice<a class="headerlink" href="#in-practice" title="Permalink to this heading"></a></h3>
<p>There are many existing interface specifications and protocols to choose from. A
typical method is to open a TCP/IP port for a container and pass data in and out
via a suitable web protocol. Alternatively, a shared service can be used to
exchange data in a formal way, for example a relational database with a
custom-designed schema. Prefer something for which reusable open source examples
are available.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the programming language you use lacks the libraries and examples on
which to base an interface, see if the language has bindings to another
programming language for which such libraries and examples are available.
And as a last resort, it is always possible to interface via files and
volumes (see above).</p>
</div>
</div></blockquote>
<p>Publish your interface specification somewhere accessible, for example on a
GitHub/GitLab wiki attached to the repository holding the code of your model or
app.</p>
</section>
</section>
<section id="interfacing-via-a-message-broker">
<span id="broker"></span><h2>Interfacing via a message broker<a class="headerlink" href="#interfacing-via-a-message-broker" title="Permalink to this heading"></a></h2>
<p>You can interface via a <strong>message broker</strong> that forwards and queues messages.
Doing so can yield several benefits:</p>
<ul class="simple">
<li><p>Convenience</p>
<ul>
<li><p>The broker uses a standard protocol: only one thing to learn.</p></li>
<li><p>The broker takes care of details such as message routing: the protocol can
therefore be relatively simple.</p></li>
<li><p>Client libraries for sending and receiving messages are available for
various programming languages.</p></li>
</ul>
</li>
<li><p>Decoupling</p>
<ul>
<li><p>Containers need to interface only to the broker instead of to each
collaborating container.</p></li>
<li><p>Containers can receive messages asynchronously.</p></li>
</ul>
</li>
<li><p>Scalability</p>
<ul>
<li><p>Multiple producing containers can queue input for a single consuming
container: additional instances of producing containers can be added as
needed to maximize throughput.</p></li>
<li><p>Multiple consuming containers can dequeue output of a single producing
container: additional instances of consuming containers can be added as
needed to handle the workload.</p></li>
<li><p>Brokers may support federation or distributed delivery.</p></li>
</ul>
</li>
<li><p>Robustness</p>
<ul>
<li><p>The broker can be configured to re-queue an unhandled message when the
consuming container fails.</p></li>
<li><p>The broker can be configured to persist messages so that they are again
queued after the broker fails and restarts.</p></li>
<li><p>The broker can verify delivery and handling.</p></li>
</ul>
</li>
<li><p>Monitoring and testing</p>
<ul>
<li><p>A message broker provides a web interface via which queues and messages can
be monitored to assess function and performance.</p></li>
<li><p>Interactive message dispatch and receipt are possible via the web interface,
thereby assisting in the manual testing of interfaces.</p></li>
</ul>
</li>
</ul>
<p>For ForestNavigator, <a class="reference internal" href="../IT-infrastructure/RabbitMQ.html#rabbitmq"><span class="std std-ref">Rabbit MQ</span></a> is the default and recommended
message broker. It is deployed in a separate container.</p>
</section>
<section id="application-programming-interfaces">
<span id="index-3"></span><h2>Application Programming Interfaces<a class="headerlink" href="#application-programming-interfaces" title="Permalink to this heading"></a></h2>
<p>When your container provides a service of general utility, you need to enable
any random other container (a client) to use your service. For a simple or
asynchronous service, it may suffice to have your container wait on messages
posted to a message queue as discussed in the previous section. To then make
your container useable, you will need to document the message format and queue
access.</p>
<p id="index-4">When the service is intricate or has to respond immediately, defining an
Application Programming Interface (<a class="reference external" href="https://en.wikipedia.org/wiki/API">API</a>)
may be more appropriate. In the context of interfaces between containers, this
is almost always a <a class="reference external" href="https://en.wikipedia.org/wiki/Web_API">Web API</a>.</p>
<p id="index-5">Because you have no control over what software runs in the client containers, it
is important to enable the use of the API from an arbitrary programming
language, ideally by providing client libraries for some of the more popular
languages. Also, you need to provide documentation for your API. The <a class="reference external" href="https://en.wikipedia.org/wiki/OpenAPI_Specification">OpenAPI
Specification</a> and
related tools can assist that effort. Applications implemented based on OpenAPI
interface files can automatically generate documentation of methods, parameters
and models. Client and server <a class="reference external" href="https://openapi-generator.tech/docs/generators">code generators for various languages</a> are also available. This
helps keep the documentation, client libraries and source code in sync.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="networking.html" class="btn btn-neutral float-left" title="Networking" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="determining-the-modality-of-execution.html" class="btn btn-neutral float-right" title="Determining the modality of execution" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Albert Brouwer, IIASA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>